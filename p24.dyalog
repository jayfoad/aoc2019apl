p←'#'=↑⊃⎕NGET'p24.txt'1
A←3 3⍴0 1 ⋄ f←{+/,A×⍵}⌺3 3
2⊥⌽,⍬{⍺∊⍨⊂⍵:⍵ ⋄ (⍺,⊂⍵)∇1=n-⍵<2=n←f ⍵}p ⍝ part 1
g←{1↓0⍪⍨5/[2]1 ¯3 1\⍵[;,3;2 4]}
h←{¯1↓0⍪0 0 1 0 0\[2]0 1 0 1 0\1 2⍴⍤1+/[2]1 0 0 0 1/⍵}
+/,{{0@(⊂3 3)⊢⍵}⍤2⊢1=n-⍵<2=n←(⍉⍤2 h⍉⍤2⊢⍵)+(h ⍵)+(⍉⍤2 g⍉⍤2⊢⍵)+(g ⍵)+f⍤2⊢⍵}∘{0⍪0⍪⍨⍵}⍣200⊢p⍴⍨1,⍴p ⍝ part 2
