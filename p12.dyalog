⎕PP←17
p←⍎¨¨'-?\d+'⎕S'&'¨⊃⎕NGET'p12.txt'1
f←{p v←⍵ ⋄ v+←+⌿×∘.-⍨p ⋄ (p+v)v}
e←{+/⊃×/+/¨¨|⍵}
e f⍣1000⊢p 0 ⍝ part 1
a←⍬ ⋄ {3E5=≢a: ⋄ a,←⊂⍵ ⋄ ∇f ⍵}p 0
∧/{⊃0~⍨(⍳≢⍵)-⍳⍨⍵}⍤3⊢2 3 4 1⍉↑↑↑a ⍝ part 2
